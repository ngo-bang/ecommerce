

{{!-- <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css"> --}}
{{!-- <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script> --}}
{{!-- <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> --}}
<!------ Include the above in your HEAD tag ---------->

<link rel="stylesheet" href="https://fontawesome.com/v4.7.0/assets/font-awesome/css/font-awesome.css">


<div class="container pt-5">
    <div class="pt-5">

    
    <div class="row pt-5">

        <aside class=" col-md-3">
            <form id="filter" method="post">
                <div class="card">
                    <article class="filter-group">
                        <header class="card-header">
                            <a href="#" data-toggle="collapse" data-target="#collapse_1" aria-expanded="true" class="">
                                <i class="icon-control fa fa-chevron-down"></i>
                                <h6 class="title">Category Types</h6>
                            </a>
                        </header>


                        <div class="filter-content collapse show" id="collapse_2" style="">
                            <div class="card-body">

                                {{#each category}}

                                <label class="custom-control custom-checkbox">
                                    <input type="checkbox" class="custom-control-input" value="{{this.CategoryName}}"
                                        name="category">
                                    <div class="custom-control-label">{{this.CategoryName}}
                                    </div>
                                </label>
                                {{/each}}
                                <label class="custom-control custom-checkbox">
                                    <input type="checkbox" class="custom-control-input" name="category" value="" hidden
                                        checked>

                                </label>

                            </div>
                        </div>
                    </article>


                    <!-- filter-group  .// -->
                    <article class="filter-group">
                        <header class="card-header">
                            <a href="#" data-toggle="collapse" data-target="#collapse_2" aria-expanded="true" class="">
                                <i class="icon-control fa fa-chevron-down"></i>
                                <h6 class="title">Brands </h6>
                            </a>
                        </header>
                        <div class="filter-content collapse show" id="collapse_2" style="">
                            <div class="card-body">

                                {{#each brand}}

                                <label class="custom-control custom-checkbox">
                                    <input type="checkbox" class="custom-control-input" value="{{this.brandName}}"
                                        name="brand">
                                    <div class="custom-control-label">{{this.brandName}}
                                    </div>
                                </label>
                                {{/each}}
                                <label class="custom-control custom-checkbox">
                                    <input type="checkbox" class="custom-control-input" name="brand" value="" hidden
                                        checked>

                                </label>

                            </div>
                        </div>
                    </article>

                    <!-- filter-group .// -->
                    <article class="filter-group">
                        <header class="card-header">
                            <a href="#" data-toggle="collapse" data-target="#collapse_3" aria-expanded="true" class="">
                                <i class="icon-control fa fa-chevron-down"></i>
                                <h6 class="title">Price range </h6>
                            </a>
                        </header>

                        <div class="filter-content collapse show" id="collapse_2" style="">
                            <div class="card-body">



                                <label class="custom-control custom-checkbox">
                                    <input type="radio" class="custom-control-input" value="1000" name="Prize">
                                    <div class="custom-control-label">Under 1000
                                    </div>
                                </label>
                                <label class="custom-control custom-checkbox">
                                    <input type="radio" class="custom-control-input" value="10000" name="Prize">
                                    <div class="custom-control-label">Under 10000
                                    </div>
                                </label>
                                <label class="custom-control custom-checkbox">
                                    <input type="radio" class="custom-control-input" value="50000" name="Prize">
                                    <div class="custom-control-label">Under 50000
                                    </div>
                                </label>
                                <label class="custom-control custom-checkbox">
                                    <input type="radio" class="custom-control-input" value="100000" name="Prize">
                                    <div class="custom-control-label">uder 100000
                                    </div>
                                </label>
                                <label class="custom-control custom-checkbox">
                                    <input type="radio" class="custom-control-input" value="200000" name="Prize">
                                    <div class="custom-control-label">uder 200000
                                    </div>
                                </label>
                                <label class="custom-control custom-checkbox">
                                    <input type="radio" class="custom-control-input" name="Prize" value="400000" hidden
                                        checked>

                                </label>


                            </div>
                        </div>

                    </article>

                </div>
            </form>
        </aside>
        <main class="col-md-9">

      <div class="container pt-5">
				
				<div class="row "  id="products">
                    {{#each filterResult}}
					<!-- single product -->
					<div class="col-5 col-lg-6 col-md-6 pb-5">
						<div class="single-product ">
							<a href="/viewProduct/{{this._id}}"><img class="img-fluid border border-warning rounded" src="/uploads/{{this.image.[0].image1}}" alt=""></a>
							<div class="product-details ">
								<h6><a>{{this.productName}}</a></h6>
								<div class="price">
									<h6>${{this.price}}</h6>
									<h6 style="color:darkred" class="l-through">Rs {{this.MRP}}</h6>
                                    <h6 style="color:darkred" >{{this.discount}} % off</h6>
								</div>
                                

                                {{#if ../user}}
							<div class="prd-bottom ">

								<span class="social-info" onclick="addToWishlist('{{this._id}}')">
									<span class="lnr lnr-heart"></span>
									<p class="hover-text"> Wishlist</p>
								</span>

								<span class="social-info" onclick="addToCart('{{this._id}}')">
									<span class="ti-bag"></span>
									<p class="hover-text">add Cart</p>
								</span>
							</div>
							
                          {{else}}
							<div class="prd-bottom ">

								<a href="/login"><span class="social-info">
									<span class="lnr lnr-heart"></span>
									<p class="hover-text"> Wishlist</p>
								</span></a>

								<a href="/login"><span class="social-info" >
									<span class="ti-bag"></span>
									<p class="hover-text">add Cart</p>
								</span></a>
							</div>
							{{/if}}


							</div>
						</div>
					</div>
                    {{/each}}
					
					
				</div>
			</div>
            

        




    </div>


   

    </main>
</div>
</div>
</div>


<script>

function addToWishlist(proId) {
		$.ajax({
			url: "/AddToWishlist/" + proId,
			methode: "get",
			success: (Response) => {

				if (Response.modifiedCount == 1) {
                    Swal.fire({
                    icon: 'success',
                    title: '',
                    text: 'Added to Wishlist',
                    footer: ''
                  })

					let count = $('#wishCount').html()
					count = parseInt(count) + 1
					$("#wishCount").html(parseInt(count))


				}
			}
		})

	}

    function addToCart(proId) {

		$.ajax({
			url: "/AddToCart/" + proId,
			methode: "get",
			success: (Response) => {


				if (Response.modifiedCount == 1) {
                    Swal.fire({
                    icon: 'success',
                    title: '',
                    text: 'Added to Cart',
                    footer: ''
                  })
					let count = $('#cartCount').html()
					count = parseInt(count) + 1
					$("#cartCount").html(parseInt(count))

				}
			}
		})
	}



    $('input[name=brand]').change(function() {
   
    $.ajax({
        url: '/search-filter',  
        method: "post",
        data: $('#filter').serialize(),
        success: (isResult) => {
            
            if (isResult) {
                $('#products').load(location.href + " #products");
            }
        }
    })

  });

   $('input[name=Prize]').change(function() {
   
    $.ajax({
        url: '/search-filter',  
        method: "post",
        data: $('#filter').serialize(),
        success: (isResult) => {
            
            if (isResult) {
                $('#products').load(location.href + " #products");
            }
        }
    })

  });

   $('input[name=category]').change(function() {
   
    $.ajax({
        url: '/search-filter',  
        method: "post",
        data: $('#filter').serialize(),
        success: (isResult) => {
            if (isResult) {
                $('#products').load(location.href + " #products");
            }
        }
    })

  });
</script>